# 快速开始指南

## 🎯 5分钟快速上手

### 第一步：安装依赖

```bash
cd /mnt/okcomputer/output/index_collector
pip install -r requirements.txt
```

### 第二步：运行程序

```bash
# 方式1：图形界面（推荐）
python main.py

# 方式2：命令行
python scheduler.py --mode manual
```

### 第三步：收集数据

1. 点击"手动收集数据"按钮
2. 等待程序自动运行
3. 查看生成的Excel报告

## 📋 三种使用方式

### ✅ 方式一：图形界面（最简单）

```bash
python main.py
```

**界面功能**：
- 📊 手动收集数据 - 立即运行一次
- ⏰ 启动定时任务 - 自动每周运行
- 📈 生成Excel报告 - 生成数据报告
- 📸 查看截图 - 打开截图目录

### ✅ 方式二：命令行（适合服务器）

```bash
# 立即运行一次
python scheduler.py --mode manual

# 启动后台定时任务
python scheduler.py --mode schedule

# 无浏览器模式（Linux服务器）
python scheduler.py --mode manual --headless
```

### ✅ 方式三：Python调用（开发者）

```python
from baidu_collector import BaiduIndexCollector
from wechat_collector import WechatIndexCollector
from data_processor import DataProcessor

# 收集百度指数
baidu = BaiduIndexCollector()
baidu_data = baidu.collect_baidu_index_data(start_date, end_date)

# 收集微信指数
wechat = WechatIndexCollector()
wechat_data = wechat.collect_wechat_index_data(start_date, end_date)

# 生成报告
processor = DataProcessor()
processor.generate_excel_report("报告.xlsx")
```

## ⚙️ 配置文件（config.py）

### 修改关键词
```python
KEYWORDS = {
    'baidu': ['上海电信', '上海移动', '上海联通'],  # 修改这里
    'wechat': ['上海电信', '上海移动', '上海联通']   # 修改这里
}
```

### 修改定时时间
```python
COLLECTION_HOUR = 9  # 每天9点检查
```

### 修改浏览器设置
```python
BROWSER_CONFIG = {
    'headless': False,  # True=不显示浏览器窗口
    'window_size': '1920,1080',
    'timeout': 30
}
```

## 📊 输出文件

### 1. Excel报告

**位置**：`data/运营商指数报告_YYYYMMDD_HHMMSS.xlsx`

**包含工作表**：
- 微信指数趋势
- 百度指数搜索
- 百度指数资讯
- 数据汇总

### 2. 截图文件

**位置**：`screenshots/`

**文件名**：
- baidu_index_search_YYYYMMDD_HHMMSS.png
- baidu_index_info_YYYYMMDD_HHMMSS.png
- wechat_index_YYYYMMDD_HHMMSS.png

### 3. 日志文件

**位置**：`logs/index_collector_YYYYMMDD.log`

## 🔧 常见问题速查

### ❌ 问题1：Chrome浏览器未找到

**错误信息**：
```
selenium.common.exceptions.SessionNotCreatedException
```

**解决方法**：

1. 安装Chrome浏览器
2. 下载对应版本的ChromeDriver
3. 或将headless设为True：

```python
# 在config.py中修改
BROWSER_CONFIG = {
    'headless': True,  # 改为True
    ...
}
```

### ❌ 问题2：微信指数无法自动获取

**正常现象**：

微信指数主要通过小程序提供，技术上难以完全自动化。

**解决方案**：

工具会自动：
1. 打开提示页面
2. 显示操作指南
3. 等待手动输入数据
4. 自动截图记录

### ❌ 问题3：百度指数需要登录

**解决方法**：

1. 首次运行时关闭headless模式：
```python
BROWSER_CONFIG = {
    'headless': False,  # 设为False
    ...
}
```

2. 手动登录百度账号
3. 后续运行可以保持登录状态

### ❌ 问题4：定时任务不运行

**检查步骤**：

1. ✅ 系统时间是否正确
2. ✅ Python进程是否运行
3. ✅ 查看日志：`logs/index_collector_YYYYMMDD.log`
4. ✅ 确认是周五或周一（默认只在周五和周一收集）

## 📅 收集规则

### 自动判断收集日期

- **周五**：收集"上周四-本周四"数据
- **周一**：收集"上周四-本周四"数据（处理延迟）
- **其他时间**：手动收集最近7天

### 收集内容

| 平台 | 数据类型 | 内容 |
|------|---------|------|
| 百度指数 | 搜索指数 | 每日数值 + 周平均 |
| 百度指数 | 资讯指数 | 每日数值 + 周平均 |
| 微信指数 | 趋势指数 | 每日数值 + 周平均 |

## 📝 使用流程建议

### 初次使用

1. **运行测试**
   ```bash
   python main.py
   ```

2. **检查输出**
   - 查看Excel报告格式
   - 检查截图是否保存
   - 确认数据是否准确

3. **调整配置**
   - 修改关键词（如需要）
   - 调整浏览器设置
   - 设置定时时间

### 日常使用

**方案A：手动收集（推荐新手）**
```bash
# 每周五运行一次
python main.py
# 点击"手动收集数据"
```

**方案B：定时收集（推荐进阶）**
```bash
# 启动定时任务
python scheduler.py --mode schedule
# 后台自动运行
```

**方案C：服务器部署**
```bash
# 使用Linux定时任务
crontab -e
# 添加：
0 9 * * 1,5 cd /path/to/index_collector && python scheduler.py --mode manual --headless
```

## 🎨 自定义Excel报告

### 修改样式

在`data_processor.py`中修改：

```python
# 修改颜色
header_fill = PatternFill(start_color="4472C4", end_color="4472C4", fill_type="solid")
peak_fill = PatternFill(start_color="FF0000", end_color="FF0000", fill_type="solid")

# 修改字体
header_font = Font(bold=True, color="FFFFFF", size=11)
peak_font = Font(color="FFFFFF", bold=True)
```

### 添加新列

在`config.py`中修改：

```python
EXCEL_TEMPLATE = {
    '微信指数趋势': {
        'columns': ['日期', '星期', '上海电信', ...],  # 添加新列
        ...
    }
}
```

## 🔍 故障排查

### 查看日志

```bash
# 查看最新日志
tail -f logs/index_collector_$(date +%Y%m%d).log

# 查看所有日志
ls -la logs/
```

### 测试运行

```bash
# 调试模式（显示浏览器）
python main.py

# 无浏览器模式
python scheduler.py --mode manual --headless
```

### 检查文件

```bash
# 检查目录结构
ls -la

# 检查截图
ls -la screenshots/

# 检查报告
ls -la data/
```

## 📞 获取帮助

### 查看文档

- 📖 **完整文档**：查看`README.md`
- 📘 **配置说明**：查看`config.py`注释
- 📙 **代码注释**：各模块都有详细注释

### 常见问题

1. **Q**：运行报错怎么办？
   **A**：查看日志文件，搜索错误信息

2. **Q**：微信指数无法自动获取？
   **A**：这是正常现象，使用手动辅助模式

3. **Q**：如何修改收集时间？
   **A**：修改`config.py`中的`COLLECTION_HOUR`

4. **Q**：如何添加新的运营商？
   **A**：修改`config.py`中的`KEYWORDS`

5. **Q**：报告格式可以自定义吗？
   **A**：可以，修改`data_processor.py`中的样式设置

## 🎯 下一步

### 立即开始

✅ 安装依赖：`pip install -r requirements.txt`  
✅ 运行程序：`python main.py`  
✅ 收集数据：点击"手动收集数据"  
✅ 查看报告：在`data/`目录下  

### 进阶使用

- 🔧 修改配置文件
- ⏰ 设置定时任务
- 📧 添加邮件通知
- 📊 自定义报告格式
- 🎨 修改界面样式

---

**提示**：
- 首次运行时建议关闭headless模式，观察运行过程
- 定期查看日志文件，确保程序正常运行
- 每周检查生成的Excel报告，确认数据准确性

**技术支持**：查看`README.md`完整文档