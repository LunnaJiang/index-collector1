# 项目文件说明

## 📁 文件列表

### 核心代码文件

| 文件名 | 大小 | 说明 |
|--------|------|------|
| **main.py** | 10.9 KB | 图形用户界面主程序 |
| **scheduler.py** | 7.7 KB | 定时任务调度系统 |
| **baidu_collector.py** | 11.5 KB | 百度指数数据收集器 |
| **wechat_collector.py** | 13.8 KB | 微信指数数据收集器 |
| **data_processor.py** | 16.8 KB | 数据处理和Excel报告生成 |
| **config.py** | 3.8 KB | 配置文件 |

### 工具脚本

| 文件名 | 大小 | 说明 |
|--------|------|------|
| **install.py** | 7.2 KB | 自动安装脚本 |
| **test_environment.py** | 5.6 KB | 环境测试脚本 |
| **requirements.txt** | 396 B | Python依赖包列表 |

### 文档文件

| 文件名 | 大小 | 说明 |
|--------|------|------|
| **README.md** | 8.5 KB | 完整使用说明文档 |
| **快速开始指南.md** | 7.3 KB | 5分钟快速上手指南 |
| **项目文件说明.md** | 当前文件 | 本文件 |

### 目录

| 目录名 | 说明 |
|--------|------|
| **screenshots/** | 截图保存目录（自动创建） |
| **data/** | Excel报告保存目录（自动创建） |
| **logs/** | 日志文件保存目录（自动创建） |

## 📖 文件详细说明

### 1. main.py - 图形用户界面

**功能**：
- 提供友好的图形用户界面（Tkinter）
- 集成所有功能模块
- 实时显示运行日志
- 支持手动/自动模式切换

**主要组件**：
- `IndexCollectorGUI` 类
- 手动收集按钮
- 定时任务控制
- 报告生成按钮
- 截图查看功能

**使用方法**：
```bash
python main.py
```

### 2. scheduler.py - 定时任务调度

**功能**：
- 定时执行数据收集任务
- 支持周五/周一自动收集
- 日志记录和错误处理
- 后台运行模式

**主要组件**：
- `IndexScheduler` 类
- 任务调度系统
- 通知功能（可扩展）

**使用方法**：
```bash
# 手动运行一次
python scheduler.py --mode manual

# 启动定时任务
python scheduler.py --mode schedule

# 无浏览器模式
python scheduler.py --mode manual --headless
```

### 3. baidu_collector.py - 百度指数收集器

**功能**：
- 自动访问百度指数网站
- 搜索关键词（上海电信、上海移动、上海联通）
- 收集搜索指数和资讯指数
- 自动截图保存
- 设置日期范围

**主要组件**：
- `BaiduIndexCollector` 类
- 浏览器自动化（Selenium）
- 数据解析功能
- 截图功能

**使用方法**：
```python
from baidu_collector import BaiduIndexCollector

collector = BaiduIndexCollector(headless=True)
data = collector.collect_baidu_index_data(start_date, end_date)
```

### 4. wechat_collector.py - 微信指数收集器

**功能**：
- 尝试访问微信指数网页版
- 提供手动收集辅助模式
- 自动生成操作指南
- 截图记录功能

**主要组件**：
- `WechatIndexCollector` 类
- 网页版自动收集
- 手动辅助模式
- 操作指南生成

**使用方法**：
```python
from wechat_collector import WechatIndexCollector

collector = WechatIndexCollector(headless=True)
data = collector.collect_wechat_index_data(start_date, end_date)
```

**特殊说明**：
- 微信指数主要通过小程序提供，技术限制较多
- 工具提供手动辅助收集模式
- 自动截图记录操作过程

### 5. data_processor.py - 数据处理

**功能**：
- 处理收集到的原始数据
- 计算每周平均值
- 生成Excel报告
- 应用样式和格式

**主要组件**：
- `DataProcessor` 类
- 数据解析和计算
- Excel报告生成
- 样式应用

**使用方法**：
```python
from data_processor import DataProcessor

processor = DataProcessor()
processor.process_baidu_data(baidu_data)
processor.process_wechat_data(wechat_data)
processor.generate_excel_report("报告.xlsx")
```

**Excel报告结构**：
- 微信指数趋势表
- 百度指数搜索表
- 百度指数资讯表
- 数据汇总表

### 6. config.py - 配置文件

**功能**：
- 集中管理所有配置项
- 关键词配置
- URL配置
- 时间配置
- 浏览器配置
- Excel模板配置

**主要配置项**：

```python
# 关键词配置
KEYWORDS = {
    'baidu': ['上海电信', '上海移动', '上海联通'],
    'wechat': ['上海电信', '上海移动', '上海联通']
}

# 时间配置
COLLECTION_DAYS = 7
COLLECTION_HOUR = 9

# 浏览器配置
BROWSER_CONFIG = {
    'headless': False,
    'window_size': '1920,1080',
    'timeout': 30
}

# Excel模板配置
EXCEL_TEMPLATE = {
    # ... 详见配置文件
}
```

**自定义方法**：
- 直接修改config.py文件
- 或在运行时动态修改

### 7. install.py - 自动安装脚本

**功能**：
- 检查Python版本
- 检查Chrome浏览器
- 检查pip可用性
- 自动安装依赖包
- 创建必要目录
- 测试环境

**使用方法**：
```bash
python install.py
```

**检查项**：
- ✅ Python版本（3.8+）
- ✅ Chrome浏览器
- ✅ pip包管理器
- ✅ 依赖包安装
- ✅ 目录创建
- ✅ 模块导入测试

### 8. test_environment.py - 环境测试

**功能**：
- 测试基础模块导入
- 检查项目结构完整性
- 测试配置文件
- 检查可选依赖
- 测试目录创建

**使用方法**：
```bash
python test_environment.py
```

**测试项目**：
- 基础模块（sys, os, datetime等）
- 项目文件是否齐全
- config.py是否正确配置
- 可选依赖是否安装
- 目录是否可写

### 9. requirements.txt - 依赖包列表

**内容**：
```
selenium==4.15.2
pandas==2.1.3
numpy==1.26.2
openpyxl==3.1.2
schedule==1.2.0
requests==2.31.0
Pillow==10.1.0
```

**安装方法**：
```bash
pip install -r requirements.txt
```

### 10. README.md - 完整文档

**内容**：
- 项目简介
- 主要功能
- 技术架构
- 安装说明
- 使用说明
- 配置说明
- 常见问题
- 注意事项

**适合人群**：
- 初次使用者
- 需要完整功能的用户
- 需要自定义配置的用户

### 11. 快速开始指南.md

**内容**：
- 5分钟快速上手
- 三种使用方式
- 配置文件说明
- 输出文件说明
- 常见问题速查
- 收集规则
- 使用流程建议

**适合人群**：
- 想快速上手的用户
- 只需要基础功能的用户
- 遇到问题需要快速解决的用户

## 🚀 使用建议

### 初次使用流程

1. **环境检查**
   ```bash
   python test_environment.py
   ```

2. **自动安装**
   ```bash
   python install.py
   ```

3. **运行测试**
   ```bash
   python main.py
   ```

4. **查看文档**
   - 快速开始指南.md
   - README.md

### 日常使用

**图形界面用户**：
```bash
python main.py
```

**命令行用户**：
```bash
# 手动运行
python scheduler.py --mode manual

# 定时运行
python scheduler.py --mode schedule
```

**开发者**：
```python
# 导入模块使用
from baidu_collector import BaiduIndexCollector
from wechat_collector import WechatIndexCollector
from data_processor import DataProcessor
```

## 📞 获取帮助

### 查看文档

1. **快速开始指南.md** - 5分钟快速上手
2. **README.md** - 完整使用说明
3. **本文件** - 项目文件说明

### 常见问题

1. **环境相关问题** → 查看`test_environment.py`
2. **安装相关问题** → 运行`python install.py`
3. **使用相关问题** → 查看`README.md`
4. **快速上手** → 查看`快速开始指南.md`

### 技术支持

- 检查日志文件：`logs/index_collector_YYYYMMDD.log`
- 运行环境测试：`python test_environment.py`
- 重新安装依赖：`python install.py`

## 📂 文件依赖关系

```
main.py
├── scheduler.py
│   ├── baidu_collector.py
│   ├── wechat_collector.py
│   └── data_processor.py
├── baidu_collector.py
│   └── config.py
├── wechat_collector.py
│   └── config.py
└── data_processor.py
    └── config.py

config.py (所有模块都依赖)
requirements.txt (所有模块都依赖)
```

## 📝 文件大小统计

**代码文件总大小**：约 65 KB
**文档文件总大小**：约 21 KB
**总计**：约 86 KB

---

**说明**：本文件详细列出了所有项目文件的功能和使用方法，便于快速了解项目结构和各模块作用。